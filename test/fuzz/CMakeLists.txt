function(build_fuzzer NAME)
    add_executable("${NAME}" "${NAME}.cpp" validators.cpp validators.h fuzzers.cpp fuzzers.h)
    target_link_libraries("${NAME}" "${CUB_NAME}" test_tools pthread)
    target_include_directories("${NAME}" PRIVATE "${CUB_TEST_DIR}/tools")
    target_include_directories("${NAME}" PRIVATE "${CUB_SOURCE_DIR}")
    target_include_directories("${NAME}" PRIVATE "${CUB_INCLUDE_DIR}")
    target_compile_options("${NAME}" PRIVATE "${CUB_WARNINGS}" -fsanitize=address,fuzzer)
    target_link_options("${NAME}" PRIVATE -fsanitize=address,fuzzer)
endfunction()

build_fuzzer(fuzz_ops)
build_fuzzer(fuzz_wal)

add_executable(corpus_generator corpus.cpp fuzzers.cpp fuzzers.h validators.cpp validators.h)
target_link_libraries(corpus_generator "${CUB_NAME}" test_tools pthread)
target_include_directories(corpus_generator PRIVATE "${CUB_TEST_DIR}/tools")
target_include_directories(corpus_generator PRIVATE "${CUB_SOURCE_DIR}")
target_include_directories(corpus_generator PRIVATE "${CUB_INCLUDE_DIR}")
target_compile_options(corpus_generator PRIVATE "${CUB_WARNINGS}")
